<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manufacturer Login - SupplyChain</title>
    <link rel="stylesheet" href="styles/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <nav class="navbar">
      <div class="container nav-container">
        <a href="index.html" class="logo">
          <i class="fas fa-cubes"></i> Supply<span>Chain</span>
        </a>

        <div class="nav-center">
          <a href="verify.html" class="nav-verify-link"
            ><i class="fas fa-shield-alt"></i> Verify</a
          >
        </div>

        <a href="login.html" class="btn btn-primary register-btn">
          <i class="fas fa-plus-circle"></i> Register a Product
        </a>
      </div>
    </nav>

    <main class="container container-narrow">
      <div class="hero hero-sm">
        <h1>Manufacturer Authentication</h1>
        <p>Login or create an account to register products</p>
      </div>

      <div class="card" style="max-width: 500px; margin: 0 auto">
        <div
          class="auth-tabs"
          style="
            display: flex;
            gap: 0;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--gray-200);
          "
        >
          <button
            class="tab-btn active"
            data-tab="login"
            style="
              flex: 1;
              padding: 1rem;
              background: none;
              border: none;
              cursor: pointer;
              font-weight: 600;
              color: var(--primary);
              border-bottom: 3px solid var(--primary);
              margin-bottom: -2px;
            "
          >
            <i class="fas fa-sign-in-alt"></i> Login
          </button>
          <button
            class="tab-btn"
            data-tab="signup"
            style="
              flex: 1;
              padding: 1rem;
              background: none;
              border: none;
              cursor: pointer;
              font-weight: 600;
              color: var(--secondary);
            "
          >
            <i class="fas fa-user-plus"></i> Sign Up
          </button>
        </div>

        <!-- Login Form -->
        <div id="loginTab" class="auth-form">
          <h2 class="card-title">Login</h2>
          <form id="loginForm">
            <div class="form-group">
              <label class="form-label" for="loginEmail">Email *</label>
              <input
                type="email"
                id="loginEmail"
                class="form-control"
                placeholder="Enter your email"
                required
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="loginPassword">Password *</label>
              <input
                type="password"
                id="loginPassword"
                class="form-control"
                placeholder="Enter your password"
                required
              />
            </div>

            <div class="alert alert-info">
              <i class="fas fa-info-circle"></i> Use demo credentials:
              demo@manufacturer.com / password123
            </div>

            <button type="submit" class="btn btn-primary btn-block">
              <i class="fas fa-sign-in-alt"></i> Login
            </button>
          </form>
        </div>

        <!-- Signup Form -->
        <div id="signupTab" class="auth-form" style="display: none">
          <h2 class="card-title">Create Account</h2>
          <form id="signupForm">
            <div class="form-group">
              <label class="form-label" for="signupName">Company Name *</label>
              <input
                type="text"
                id="signupName"
                class="form-control"
                placeholder="Enter company name"
                required
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="signupEmail">Email *</label>
              <input
                type="email"
                id="signupEmail"
                class="form-control"
                placeholder="Enter your email"
                required
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="signupPassword">Password *</label>
              <input
                type="password"
                id="signupPassword"
                class="form-control"
                placeholder="Create a password (min 6 characters)"
                required
                minlength="6"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="signupConfirmPassword"
                >Confirm Password *</label
              >
              <input
                type="password"
                id="signupConfirmPassword"
                class="form-control"
                placeholder="Confirm your password"
                required
              />
            </div>

            <button type="submit" class="btn btn-primary btn-block">
              <i class="fas fa-user-plus"></i> Create Account
            </button>
          </form>
        </div>

        <div id="authMessage" class="hidden mt-2"></div>
      </div>

      <div class="card mt-3">
        <h3><i class="fas fa-shield-alt"></i> Manufacturer Only Access</h3>
        <p>
          This section is restricted to registered manufacturers. Your account
          will be verified before you can register products on the blockchain.
        </p>
      </div>
    </main>

    <footer>
      <div class="container text-center">
        <a
          href="index.html"
          class="btn btn-secondary"
          style="margin-right: 1rem"
        >
          <i class="fas fa-arrow-left"></i> Back
        </a>
        <p class="mt-3">SupplyChain Blockchain System</p>
      </div>
    </footer>

    <script>
      // Tab switching
      const tabButtons = document.querySelectorAll(".tab-btn");
      const authForms = document.querySelectorAll(".auth-form");
      const loginForm = document.getElementById("loginForm");
      const signupForm = document.getElementById("signupForm");
      const authMessage = document.getElementById("authMessage");

      tabButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const tabName = btn.dataset.tab;

          // Update button styles
          tabButtons.forEach((b) => {
            b.classList.remove("active");
            b.style.color = "var(--secondary)";
            b.style.borderBottom = "none";
            b.style.marginBottom = "0";
          });
          btn.classList.add("active");
          btn.style.color = "var(--primary)";
          btn.style.borderBottom = "3px solid var(--primary)";
          btn.style.marginBottom = "-2px";

          // Update form visibility
          authForms.forEach((form) => (form.style.display = "none"));
          document.getElementById(tabName + "Tab").style.display = "block";
          authMessage.classList.add("hidden");
        });
      });

      // Login handler
      loginForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const email = document.getElementById("loginEmail").value;
        const password = document.getElementById("loginPassword").value;

        // Simple validation (in production, this would be server-side)
        if (email && password) {
          // Store manufacturer info in localStorage
          localStorage.setItem(
            "manufacturerAuth",
            JSON.stringify({
              email,
              companyName: email.split("@")[0],
              loginTime: new Date().toISOString(),
            }),
          );

          showMessage("Login successful! Redirecting...", "success");
          setTimeout(() => {
            window.location.href = "register.html";
          }, 1500);
        }
      });

      // Signup handler
      signupForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const name = document.getElementById("signupName").value;
        const email = document.getElementById("signupEmail").value;
        const password = document.getElementById("signupPassword").value;
        const confirmPassword = document.getElementById(
          "signupConfirmPassword",
        ).value;

        if (password !== confirmPassword) {
          showMessage("Passwords do not match", "error");
          return;
        }

        if (email && password && name) {
          // Store manufacturer info in localStorage
          localStorage.setItem(
            "manufacturerAuth",
            JSON.stringify({
              email,
              companyName: name,
              loginTime: new Date().toISOString(),
            }),
          );

          showMessage(
            "Account created successfully! Redirecting...",
            "success",
          );
          setTimeout(() => {
            window.location.href = "register.html";
          }, 1500);
        }
      });

      function showMessage(msg, type) {
        authMessage.innerHTML = `<div class="alert alert-${type}"><i class="fas fa-${type === "success" ? "check-circle" : "exclamation-circle"}"></i> ${msg}</div>`;
        authMessage.classList.remove("hidden");
      }

      // Check if already logged in
      window.addEventListener("load", () => {
        const auth = localStorage.getItem("manufacturerAuth");
        if (auth) {
          // Already authenticated, redirect to register page
          window.location.href = "register.html";
        }
      });
    </script>
  </body>
</html>
